{"version":3,"file":"mockApi.js","sources":["utils/mockApi.js"],"sourcesContent":["/**\n * Mock API - 用于在没有后端服务时模拟API请求\n */\n\nexport const mockApi = {\n    /**\n     * 创建订单\n     * @param {Object} orderData 订单数据\n     * @returns {Object} 创建的订单\n     */\n    createOrder(orderData) {\n        // 生成订单ID\n        const orderId = `order_${Date.now()}_${Math.floor(Math.random() * 1000)}`\n        \n        // 创建订单记录\n        const order = {\n            orderId: orderId,\n            userId: orderData.userId,\n            orderStatus: 'pending', // 初始状态为待支付\n            totalAmount: orderData.totalAmount,\n            discountAmount: orderData.discountAmount,\n            actualAmount: orderData.actualAmount,\n            couponId: orderData.couponId,\n            deliveryType: orderData.deliveryType,\n            storeName: orderData.storeName,\n            storeAddress: orderData.storeAddress,\n            contactName: orderData.contactName,\n            contactPhone: orderData.contactPhone,\n            deliveryAddress: orderData.deliveryAddress,\n            orderItems: orderData.orderItems,\n            createTime: Date.now(),\n            updateTime: Date.now()\n        }\n        \n        // 保存到localStorage\n        this.saveOrderToStorage(order)\n        \n        console.log('Mock API - 创建订单成功:', order)\n        return order\n    },\n    \n    /**\n     * 获取用户订单列表\n     * @param {string} userId 用户ID\n     * @returns {Array} 用户订单列表\n     */\n    getUserOrders(userId) {\n        // 从localStorage获取所有订单\n        const allOrders = this.getAllOrdersFromStorage()\n        \n        // 过滤出当前用户的订单\n        const userOrders = allOrders.filter(order => order.userId === userId)\n        \n        // 按创建时间倒序排序\n        userOrders.sort((a, b) => b.createTime - a.createTime)\n        \n        console.log('Mock API - 获取用户订单:', userOrders.length, '条记录')\n        return userOrders\n    },\n    \n    /**\n     * 获取订单详情\n     * @param {string} orderId 订单ID\n     * @returns {Object|null} 订单详情\n     */\n    getOrderById(orderId) {\n        // 从localStorage获取所有订单\n        const allOrders = this.getAllOrdersFromStorage()\n        \n        // 查找指定订单\n        const order = allOrders.find(order => order.orderId === orderId)\n        \n        console.log('Mock API - 获取订单详情:', order ? '成功' : '未找到')\n        return order || null\n    },\n    \n    /**\n     * 取消订单\n     * @param {string} orderId 订单ID\n     * @returns {boolean} 操作结果\n     */\n    cancelOrder(orderId) {\n        // 从localStorage获取所有订单\n        const allOrders = this.getAllOrdersFromStorage()\n        \n        // 查找指定订单索引\n        const orderIndex = allOrders.findIndex(order => order.orderId === orderId)\n        \n        if (orderIndex !== -1) {\n            // 更新订单状态\n            allOrders[orderIndex].orderStatus = 'cancelled'\n            allOrders[orderIndex].updateTime = Date.now()\n            \n            // 保存更新后的订单列表\n            this.saveAllOrdersToStorage(allOrders)\n            \n            console.log('Mock API - 取消订单成功:', orderId)\n            return true\n        }\n        \n        console.log('Mock API - 取消订单失败: 订单不存在', orderId)\n        return false\n    },\n    \n    /**\n     * 删除订单\n     * @param {string} orderId 订单ID\n     * @returns {boolean} 操作结果\n     */\n    deleteOrder(orderId) {\n        // 从localStorage获取所有订单\n        const allOrders = this.getAllOrdersFromStorage()\n        \n        // 查找指定订单索引\n        const orderIndex = allOrders.findIndex(order => order.orderId === orderId)\n        \n        if (orderIndex !== -1) {\n            // 从数组中移除订单\n            allOrders.splice(orderIndex, 1)\n            \n            // 保存更新后的订单列表\n            this.saveAllOrdersToStorage(allOrders)\n            \n            console.log('Mock API - 删除订单成功:', orderId)\n            return true\n        }\n        \n        console.log('Mock API - 删除订单失败: 订单不存在', orderId)\n        return false\n    },\n    \n    /**\n     * 将订单保存到localStorage\n     * @param {Object} order 订单对象\n     */\n    saveOrderToStorage(order) {\n        // 获取现有订单列表\n        const orders = this.getAllOrdersFromStorage()\n        \n        // 添加新订单\n        orders.push(order)\n        \n        // 保存到localStorage\n        this.saveAllOrdersToStorage(orders)\n    },\n    \n    /**\n     * 从localStorage获取所有订单\n     * @returns {Array} 订单列表\n     */\n    getAllOrdersFromStorage() {\n        try {\n            const ordersStr = localStorage.getItem('milkstore_orders')\n            return ordersStr ? JSON.parse(ordersStr) : []\n        } catch (error) {\n            console.error('解析订单数据失败:', error)\n            return []\n        }\n    },\n    \n    /**\n     * 将所有订单保存到localStorage\n     * @param {Array} orders 订单列表\n     */\n    saveAllOrdersToStorage(orders) {\n        try {\n            localStorage.setItem('milkstore_orders', JSON.stringify(orders))\n        } catch (error) {\n            console.error('保存订单数据失败:', error)\n        }\n    },\n    \n    /**\n     * 根据orderId支付订单（修改状态为 paid）\n     * @param {string} orderId 订单ID\n     * @returns {boolean} 操作结果\n     */\n    payOrder(orderId) {\n        // 从localStorage获取所有订单\n        const allOrders = this.getAllOrdersFromStorage()\n        \n        // 查找指定订单索引\n        const orderIndex = allOrders.findIndex(order => order.orderId === orderId)\n        \n        if (orderIndex !== -1) {\n            // 更新订单状态\n            allOrders[orderIndex].orderStatus = 'paid'\n            allOrders[orderIndex].updateTime = Date.now()\n            allOrders[orderIndex].payTime = Date.now()\n            \n            // 保存更新后的订单列表\n            this.saveAllOrdersToStorage(allOrders)\n            \n            console.log('Mock API - 支付订单成功:', orderId)\n            return true\n        }\n        \n        console.log('Mock API - 支付订单失败: 订单不存在', orderId)\n        return false\n    },\n    \n    /**\n     * 完成订单（修改状态为 completed）\n     * @param {string} orderId 订单ID\n     * @returns {boolean} 操作结果\n     */\n    completeOrder(orderId) {\n        // 从localStorage获取所有订单\n        const allOrders = this.getAllOrdersFromStorage()\n        \n        // 查找指定订单索引\n        const orderIndex = allOrders.findIndex(order => order.orderId === orderId)\n        \n        if (orderIndex !== -1) {\n            // 更新订单状态\n            allOrders[orderIndex].orderStatus = 'completed'\n            allOrders[orderIndex].updateTime = Date.now()\n            allOrders[orderIndex].completeTime = Date.now()\n            \n            // 保存更新后的订单列表\n            this.saveAllOrdersToStorage(allOrders)\n            \n            console.log('Mock API - 完成订单成功:', orderId)\n            return true\n        }\n        \n        console.log('Mock API - 完成订单失败: 订单不存在', orderId)\n        return false\n    }\n} "],"names":["uni","order"],"mappings":";;AAIY,MAAC,UAAU;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAMnB,YAAY,WAAW;AAEnB,UAAM,UAAU,SAAS,KAAK,IAAG,CAAE,IAAI,KAAK,MAAM,KAAK,OAAM,IAAK,GAAI,CAAC;AAGvE,UAAM,QAAQ;AAAA,MACV;AAAA,MACA,QAAQ,UAAU;AAAA,MAClB,aAAa;AAAA;AAAA,MACb,aAAa,UAAU;AAAA,MACvB,gBAAgB,UAAU;AAAA,MAC1B,cAAc,UAAU;AAAA,MACxB,UAAU,UAAU;AAAA,MACpB,cAAc,UAAU;AAAA,MACxB,WAAW,UAAU;AAAA,MACrB,cAAc,UAAU;AAAA,MACxB,aAAa,UAAU;AAAA,MACvB,cAAc,UAAU;AAAA,MACxB,iBAAiB,UAAU;AAAA,MAC3B,YAAY,UAAU;AAAA,MACtB,YAAY,KAAK,IAAK;AAAA,MACtB,YAAY,KAAK,IAAK;AAAA,IACzB;AAGD,SAAK,mBAAmB,KAAK;AAE7BA,kBAAAA,MAAY,MAAA,OAAA,0BAAA,sBAAsB,KAAK;AACvC,WAAO;AAAA,EACV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAOD,cAAc,QAAQ;AAElB,UAAM,YAAY,KAAK,wBAAyB;AAGhD,UAAM,aAAa,UAAU,OAAO,WAAS,MAAM,WAAW,MAAM;AAGpE,eAAW,KAAK,CAAC,GAAG,MAAM,EAAE,aAAa,EAAE,UAAU;AAErDA,kBAAA,MAAA,MAAA,OAAA,0BAAY,sBAAsB,WAAW,QAAQ,KAAK;AAC1D,WAAO;AAAA,EACV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAOD,aAAa,SAAS;AAElB,UAAM,YAAY,KAAK,wBAAyB;AAGhD,UAAM,QAAQ,UAAU,KAAK,CAAAC,WAASA,OAAM,YAAY,OAAO;AAE/DD,kBAAY,MAAA,MAAA,OAAA,0BAAA,sBAAsB,QAAQ,OAAO,KAAK;AACtD,WAAO,SAAS;AAAA,EACnB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAOD,YAAY,SAAS;AAEjB,UAAM,YAAY,KAAK,wBAAyB;AAGhD,UAAM,aAAa,UAAU,UAAU,WAAS,MAAM,YAAY,OAAO;AAEzE,QAAI,eAAe,IAAI;AAEnB,gBAAU,UAAU,EAAE,cAAc;AACpC,gBAAU,UAAU,EAAE,aAAa,KAAK,IAAK;AAG7C,WAAK,uBAAuB,SAAS;AAErCA,oBAAAA,6CAAY,sBAAsB,OAAO;AACzC,aAAO;AAAA,IACV;AAEDA,kBAAAA,MAAY,MAAA,OAAA,2BAAA,4BAA4B,OAAO;AAC/C,WAAO;AAAA,EACV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAOD,YAAY,SAAS;AAEjB,UAAM,YAAY,KAAK,wBAAyB;AAGhD,UAAM,aAAa,UAAU,UAAU,WAAS,MAAM,YAAY,OAAO;AAEzE,QAAI,eAAe,IAAI;AAEnB,gBAAU,OAAO,YAAY,CAAC;AAG9B,WAAK,uBAAuB,SAAS;AAErCA,oBAAAA,8CAAY,sBAAsB,OAAO;AACzC,aAAO;AAAA,IACV;AAEDA,kBAAAA,MAAY,MAAA,OAAA,2BAAA,4BAA4B,OAAO;AAC/C,WAAO;AAAA,EACV;AAAA;AAAA;AAAA;AAAA;AAAA,EAMD,mBAAmB,OAAO;AAEtB,UAAM,SAAS,KAAK,wBAAyB;AAG7C,WAAO,KAAK,KAAK;AAGjB,SAAK,uBAAuB,MAAM;AAAA,EACrC;AAAA;AAAA;AAAA;AAAA;AAAA,EAMD,0BAA0B;AACtB,QAAI;AACA,YAAM,YAAY,aAAa,QAAQ,kBAAkB;AACzD,aAAO,YAAY,KAAK,MAAM,SAAS,IAAI,CAAE;AAAA,IAChD,SAAQ,OAAO;AACZA,oBAAAA,MAAA,MAAA,SAAA,2BAAc,aAAa,KAAK;AAChC,aAAO,CAAE;AAAA,IACZ;AAAA,EACJ;AAAA;AAAA;AAAA;AAAA;AAAA,EAMD,uBAAuB,QAAQ;AAC3B,QAAI;AACA,mBAAa,QAAQ,oBAAoB,KAAK,UAAU,MAAM,CAAC;AAAA,IAClE,SAAQ,OAAO;AACZA,oBAAAA,MAAA,MAAA,SAAA,2BAAc,aAAa,KAAK;AAAA,IACnC;AAAA,EACJ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAOD,SAAS,SAAS;AAEd,UAAM,YAAY,KAAK,wBAAyB;AAGhD,UAAM,aAAa,UAAU,UAAU,WAAS,MAAM,YAAY,OAAO;AAEzE,QAAI,eAAe,IAAI;AAEnB,gBAAU,UAAU,EAAE,cAAc;AACpC,gBAAU,UAAU,EAAE,aAAa,KAAK,IAAK;AAC7C,gBAAU,UAAU,EAAE,UAAU,KAAK,IAAK;AAG1C,WAAK,uBAAuB,SAAS;AAErCA,oBAAAA,8CAAY,sBAAsB,OAAO;AACzC,aAAO;AAAA,IACV;AAEDA,kBAAAA,MAAY,MAAA,OAAA,2BAAA,4BAA4B,OAAO;AAC/C,WAAO;AAAA,EACV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAOD,cAAc,SAAS;AAEnB,UAAM,YAAY,KAAK,wBAAyB;AAGhD,UAAM,aAAa,UAAU,UAAU,WAAS,MAAM,YAAY,OAAO;AAEzE,QAAI,eAAe,IAAI;AAEnB,gBAAU,UAAU,EAAE,cAAc;AACpC,gBAAU,UAAU,EAAE,aAAa,KAAK,IAAK;AAC7C,gBAAU,UAAU,EAAE,eAAe,KAAK,IAAK;AAG/C,WAAK,uBAAuB,SAAS;AAErCA,oBAAAA,8CAAY,sBAAsB,OAAO;AACzC,aAAO;AAAA,IACV;AAEDA,kBAAAA,MAAY,MAAA,OAAA,2BAAA,4BAA4B,OAAO;AAC/C,WAAO;AAAA,EACV;AACL;;"}