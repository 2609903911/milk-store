{"version":3,"file":"userModel.js","sources":["utils/userModel.js"],"sourcesContent":["/**\r\n * 用户信息模型\r\n * 定义用户信息的数据结构和默认值\r\n */\r\n\r\n/**\r\n * 创建默认用户信息\r\n * @returns {Object} 默认用户信息对象\r\n */\r\nexport const createDefaultUserInfo = () => {\r\n  // 当前时间戳\r\n  const now = Date.now();\r\n  \r\n  // 创建各类优惠券示例，方便测试\r\n  const exampleCoupons = [\r\n    // 1. 折扣券示例\r\n    {\r\n      id: `coupon_${now}_1`,\r\n      title: '奶茶8折券',\r\n      type: 'discount',\r\n      value: 8, // 8折\r\n      minOrderAmount: 30, // 最低消费30元\r\n      scope: 'all',\r\n      scopeIds: [],\r\n      startTime: now,\r\n      endTime: now + 30 * 24 * 60 * 60 * 1000, // 30天后过期\r\n      status: 'valid',\r\n      description: '满30元可用，全场通用8折优惠',\r\n      imageUrl: '/static/images/coupon1.png',\r\n      isDeleted: false,\r\n      createTime: now,\r\n      usedTime: null,\r\n      source: 'system'\r\n    },\r\n    \r\n    // 2. 现金券示例\r\n    {\r\n      id: `coupon_${now}_2`,\r\n      title: '满50减10元券',\r\n      type: 'cash',\r\n      value: 10, // 减10元\r\n      minOrderAmount: 50, // 最低消费50元\r\n      scope: 'all',\r\n      scopeIds: [],\r\n      startTime: now,\r\n      endTime: now + 15 * 24 * 60 * 60 * 1000, // 15天后过期\r\n      status: 'valid',\r\n      description: '满50元可用，立减10元',\r\n      imageUrl: '/static/images/coupon2.png',\r\n      isDeleted: false,\r\n      createTime: now,\r\n      usedTime: null,\r\n      source: 'newUser'\r\n    },\r\n    \r\n    // 3. 免单券示例\r\n    {\r\n      id: `coupon_${now}_3`,\r\n      title: '免单券（最高30元）',\r\n      type: 'free',\r\n      value: 30, // 最高免除30元\r\n      minOrderAmount: 0, // 无最低消费\r\n      scope: 'member',\r\n      scopeIds: [],\r\n      startTime: now,\r\n      endTime: now + 7 * 24 * 60 * 60 * 1000, // 7天后过期\r\n      status: 'valid',\r\n      description: '订单金额直接免除，最高30元',\r\n      imageUrl: '/static/images/coupon3.png',\r\n      isDeleted: false,\r\n      createTime: now,\r\n      usedTime: null,\r\n      source: 'activity'\r\n    },\r\n    \r\n    // 4. 买一赠一券示例\r\n    {\r\n      id: `coupon_${now}_4`,\r\n      title: '买一赠一券',\r\n      type: 'buyOneGetOne',\r\n      value: 1, // 赠送1份\r\n      minOrderAmount: 0, // 无最低消费\r\n      scope: 'category',\r\n      scopeIds: ['招牌奶茶', '真鲜奶茶'], // 只适用于特定分类\r\n      startTime: now,\r\n      endTime: now + 20 * 24 * 60 * 60 * 1000, // 20天后过期\r\n      status: 'valid',\r\n      description: '指定奶茶类别买一赠一',\r\n      imageUrl: '/static/images/coupon4.png',\r\n      isDeleted: false,\r\n      createTime: now,\r\n      usedTime: null,\r\n      source: 'memberDay'\r\n    },\r\n    \r\n    // 5. 特价券示例\r\n    {\r\n      id: `coupon_${now}_5`,\r\n      title: '杨梅吐气特价券',\r\n      type: 'specialPrice',\r\n      value: 9.9, // 特价9.9元\r\n      minOrderAmount: 0, // 无最低消费\r\n      scope: 'product',\r\n      scopeIds: ['杨梅吐气'], // 只适用于特定商品\r\n      startTime: now,\r\n      endTime: now + 10 * 24 * 60 * 60 * 1000, // 10天后过期\r\n      status: 'valid',\r\n      description: '杨梅吐气特价9.9元',\r\n      imageUrl: '/static/images/coupon5.png',\r\n      isDeleted: false,\r\n      createTime: now,\r\n      usedTime: null,\r\n      source: 'promotion'\r\n    },\r\n    \r\n    // 6. 免运费券示例\r\n    {\r\n      id: `coupon_${now}_6`,\r\n      title: '免运费券',\r\n      type: 'shipping',\r\n      value: 0, // 无金额属性\r\n      minOrderAmount: 20, // 最低消费20元\r\n      scope: 'all',\r\n      scopeIds: [],\r\n      startTime: now,\r\n      endTime: now + 30 * 24 * 60 * 60 * 1000, // 30天后过期\r\n      status: 'valid',\r\n      description: '满20元免除配送费',\r\n      imageUrl: '/static/images/coupon6.png',\r\n      isDeleted: false,\r\n      createTime: now,\r\n      usedTime: null,\r\n      source: 'delivery'\r\n    }\r\n  ];\r\n  \r\n  return {\r\n    userId: '', // 用户唯一标识\r\n    nickname: '熊猫奶茶会员', // 用户昵称\r\n    avatar: '/static/images/avatar.png', // 头像地址\r\n    phone: '', // 手机号\r\n    pandaCoins: 237, // 熊猫币\r\n    coupons: exampleCoupons, // 优惠券列表，默认赠送六种不同类型的优惠券\r\n    medals: [], // 勋章列表\r\n    memberLevel: 0, // 会员等级\r\n    createTime: now, // 创建时间\r\n    lastLoginTime: now, // 最后登录时间\r\n  };\r\n};\r\n\r\n/**\r\n * 验证用户信息字段是否合法\r\n * @param {Object} userInfo - 用户信息对象\r\n * @returns {Boolean} 是否合法\r\n */\r\nexport const validateUserInfo = (userInfo) => {\r\n  if (!userInfo || typeof userInfo !== 'object') {\r\n    return false;\r\n  }\r\n  \r\n  // 基本字段类型验证\r\n  if (userInfo.userId && typeof userInfo.userId !== 'string') return false;\r\n  if (userInfo.nickname && typeof userInfo.nickname !== 'string') return false;\r\n  if (userInfo.phone && typeof userInfo.phone !== 'string') return false;\r\n  if (userInfo.pandaCoins !== undefined && typeof userInfo.pandaCoins !== 'number') return false;\r\n  \r\n  // 数组类型验证\r\n  if (userInfo.coupons && !Array.isArray(userInfo.coupons)) return false;\r\n  if (userInfo.medals && !Array.isArray(userInfo.medals)) return false;\r\n  \r\n  return true;\r\n};\r\n\r\n/**\r\n * 合并用户信息，使用默认值填充缺失字段\r\n * @param {Object} userInfo - 用户提供的信息\r\n * @returns {Object} 合并后的完整用户信息\r\n */\r\nexport const mergeWithDefaultUserInfo = (userInfo = {}) => {\r\n  const defaultInfo = createDefaultUserInfo();\r\n  return { ...defaultInfo, ...userInfo };\r\n}; "],"names":[],"mappings":"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"}