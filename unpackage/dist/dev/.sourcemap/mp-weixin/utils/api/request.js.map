{"version":3,"file":"request.js","sources":["utils/api/request.js"],"sourcesContent":["// API请求工具\r\n\r\nimport { BASE_URL, TIMEOUT, REQUEST_METHODS } from './config';\r\n\r\n/**\r\n * 通用请求函数\r\n * @param {Object} options 请求配置\r\n * @returns {Promise} 请求Promise\r\n */\r\nexport const request = (options) => {\r\n  return new Promise((resolve, reject) => {\r\n    uni.request({\r\n      url: options.url.startsWith('http') ? options.url : BASE_URL + options.url,\r\n      method: options.method || REQUEST_METHODS.GET,\r\n      data: options.data || {},\r\n      header: options.header || {},\r\n      timeout: options.timeout || TIMEOUT,\r\n      success: (res) => {\r\n        // 请求成功\r\n        if (res.statusCode >= 200 && res.statusCode < 300) {\r\n          resolve(res.data);\r\n        } else {\r\n          // HTTP错误\r\n          console.error(`请求失败: ${res.statusCode}`, res.data);\r\n          reject({\r\n            statusCode: res.statusCode,\r\n            message: res.data?.message || '请求失败',\r\n            data: res.data\r\n          });\r\n        }\r\n      },\r\n      fail: (err) => {\r\n        // 网络错误等\r\n        console.error('请求异常:', err);\r\n        reject({\r\n          statusCode: -1,\r\n          message: err.errMsg || '网络异常',\r\n          error: err\r\n        });\r\n      }\r\n    });\r\n  });\r\n};\r\n\r\n/**\r\n * GET请求\r\n * @param {String} url 请求URL\r\n * @param {Object} params URL参数\r\n * @param {Object} options 其他选项\r\n * @returns {Promise} 请求Promise\r\n */\r\nexport const get = (url, params = {}, options = {}) => {\r\n  // 处理GET参数\r\n  let requestUrl = url;\r\n  const queryParams = Object.keys(params).map(key => {\r\n    return `${encodeURIComponent(key)}=${encodeURIComponent(params[key])}`;\r\n  }).join('&');\r\n  \r\n  if (queryParams) {\r\n    requestUrl += (url.includes('?') ? '&' : '?') + queryParams;\r\n  }\r\n  \r\n  return request({\r\n    url: requestUrl,\r\n    method: REQUEST_METHODS.GET,\r\n    ...options\r\n  });\r\n};\r\n\r\n/**\r\n * POST请求\r\n * @param {String} url 请求URL\r\n * @param {Object} data 请求数据\r\n * @param {Object} options 其他选项\r\n * @returns {Promise} 请求Promise\r\n */\r\nexport const post = (url, data = {}, options = {}) => {\r\n  return request({\r\n    url,\r\n    method: REQUEST_METHODS.POST,\r\n    data,\r\n    ...options\r\n  });\r\n};\r\n\r\n/**\r\n * PUT请求\r\n * @param {String} url 请求URL\r\n * @param {Object} data 请求数据\r\n * @param {Object} options 其他选项\r\n * @returns {Promise} 请求Promise\r\n */\r\nexport const put = (url, data = {}, options = {}) => {\r\n  return request({\r\n    url,\r\n    method: REQUEST_METHODS.PUT,\r\n    data,\r\n    ...options\r\n  });\r\n};\r\n\r\n/**\r\n * DELETE请求\r\n * @param {String} url 请求URL\r\n * @param {Object} params URL参数\r\n * @param {Object} options 其他选项\r\n * @returns {Promise} 请求Promise\r\n */\r\nexport const del = (url, params = {}, options = {}) => {\r\n  // 处理DELETE参数\r\n  let requestUrl = url;\r\n  const queryParams = Object.keys(params).map(key => {\r\n    return `${encodeURIComponent(key)}=${encodeURIComponent(params[key])}`;\r\n  }).join('&');\r\n  \r\n  if (queryParams) {\r\n    requestUrl += (url.includes('?') ? '&' : '?') + queryParams;\r\n  }\r\n  \r\n  return request({\r\n    url: requestUrl,\r\n    method: REQUEST_METHODS.DELETE,\r\n    ...options\r\n  });\r\n}; "],"names":["uni","BASE_URL","REQUEST_METHODS","TIMEOUT"],"mappings":";;;AASY,MAAC,UAAU,CAAC,YAAY;AAClC,SAAO,IAAI,QAAQ,CAAC,SAAS,WAAW;AACtCA,kBAAAA,MAAI,QAAQ;AAAA,MACV,KAAK,QAAQ,IAAI,WAAW,MAAM,IAAI,QAAQ,MAAMC,4BAAW,QAAQ;AAAA,MACvE,QAAQ,QAAQ,UAAUC,iBAAAA,gBAAgB;AAAA,MAC1C,MAAM,QAAQ,QAAQ,CAAE;AAAA,MACxB,QAAQ,QAAQ,UAAU,CAAE;AAAA,MAC5B,SAAS,QAAQ,WAAWC,iBAAO;AAAA,MACnC,SAAS,CAAC,QAAQ;;AAEhB,YAAI,IAAI,cAAc,OAAO,IAAI,aAAa,KAAK;AACjD,kBAAQ,IAAI,IAAI;AAAA,QAC1B,OAAe;AAELH,wBAAAA,MAAA,MAAA,SAAA,8BAAc,SAAS,IAAI,UAAU,IAAI,IAAI,IAAI;AACjD,iBAAO;AAAA,YACL,YAAY,IAAI;AAAA,YAChB,WAAS,SAAI,SAAJ,mBAAU,YAAW;AAAA,YAC9B,MAAM,IAAI;AAAA,UACtB,CAAW;AAAA,QACF;AAAA,MACF;AAAA,MACD,MAAM,CAAC,QAAQ;AAEbA,sBAAc,MAAA,MAAA,SAAA,8BAAA,SAAS,GAAG;AAC1B,eAAO;AAAA,UACL,YAAY;AAAA,UACZ,SAAS,IAAI,UAAU;AAAA,UACvB,OAAO;AAAA,QACjB,CAAS;AAAA,MACF;AAAA,IACP,CAAK;AAAA,EACL,CAAG;AACH;AASY,MAAC,MAAM,CAAC,KAAK,SAAS,CAAA,GAAI,UAAU,CAAA,MAAO;AAErD,MAAI,aAAa;AACjB,QAAM,cAAc,OAAO,KAAK,MAAM,EAAE,IAAI,SAAO;AACjD,WAAO,GAAG,mBAAmB,GAAG,CAAC,IAAI,mBAAmB,OAAO,GAAG,CAAC,CAAC;AAAA,EACxE,CAAG,EAAE,KAAK,GAAG;AAEX,MAAI,aAAa;AACf,mBAAe,IAAI,SAAS,GAAG,IAAI,MAAM,OAAO;AAAA,EACjD;AAED,SAAO,QAAQ;AAAA,IACb,KAAK;AAAA,IACL,QAAQE,iBAAe,gBAAC;AAAA,IACxB,GAAG;AAAA,EACP,CAAG;AACH;AASY,MAAC,OAAO,CAAC,KAAK,OAAO,CAAA,GAAI,UAAU,CAAA,MAAO;AACpD,SAAO,QAAQ;AAAA,IACb;AAAA,IACA,QAAQA,iBAAe,gBAAC;AAAA,IACxB;AAAA,IACA,GAAG;AAAA,EACP,CAAG;AACH;AASY,MAAC,MAAM,CAAC,KAAK,OAAO,CAAA,GAAI,UAAU,CAAA,MAAO;AACnD,SAAO,QAAQ;AAAA,IACb;AAAA,IACA,QAAQA,iBAAe,gBAAC;AAAA,IACxB;AAAA,IACA,GAAG;AAAA,EACP,CAAG;AACH;;;;;"}